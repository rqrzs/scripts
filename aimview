local rs = game:GetService("RunService")
local localPlayer = game.Players.LocalPlayer
local mouse = localPlayer:GetMouse()
local target;

function getgun()
    for i, v in pairs(target.Character:GetChildren()) do
        if v and (v:FindFirstChild('Default') or v:FindFirstChild('Handle')) then
            return v
        end
    end
end

function get_closet()
    local a = math.huge
    local b;

    for i, v in pairs(game.Players:GetPlayers()) do
        if v ~= localPlayer and v.Character and v.Character:FindFirstChild("Head") and v.Character:FindFirstChild("HumanoidRootPart") then
            local c = game.Workspace.CurrentCamera:WorldToViewportPoint(v.Character.PrimaryPart.Position)
            local d = (Vector2.new(mouse.X, mouse.Y) - Vector2.new(c.X, c.Y)).Magnitude

            if a > d then
                b = v
                a = d
            end
        end
    end

    return b
end

mouse.KeyDown:Connect(function(z)
    if z == _G.toggle_keybind then
        _G.enable = not _G.enable
    end
end)

mouse.KeyDown:Connect(function(z)
    if z == _G.swith_nigga then
        target = get_closet()
    end
end)

local a = Instance.new("Beam")
a.Segments = 1
a.Width0 = 0.2
a.Width1 = 0.2
a.FaceCamera = true

-- Initial color setup
local colors = {
    Color3.fromRGB(25, 25, 25),
    Color3.fromRGB(230, 230, 230),
    Color3.fromRGB(24, 24, 24)
}

a.Color = ColorSequence.new(colors)

local b = Instance.new("Attachment")
local c = Instance.new("Attachment")
a.Attachment0 = b
a.Attachment1 = c
a.Parent = workspace.Terrain
b.Parent = workspace.Terrain
c.Parent = workspace.Terrain

-- Function to loop colors
local function loopColors()
    while true do
        for i = 1, #colors do
            a.Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, colors[i]),
                ColorSequenceKeypoint.new(1, colors[i % #colors + 1]) -- Loop to the next color
            })

            wait(1) -- Adjust the wait time to control the speed of the tween
        end
    end
end

task.spawn(loopColors)

task.spawn(function()
    rs.RenderStepped:Connect(function()
        local character = localPlayer.Character
        if not character then
            a.Enabled = false
            return
        end

        if _G.enable and getgun() and target.Character:FindFirstChild("BodyEffects") and target.Character:FindFirstChild("Head") then
            a.Enabled = true
            b.Position = target.Character:FindFirstChild("Head").Position
            c.Position = target.Character.BodyEffects[_G.method].Value
        else
            a.Enabled = false
        end
    end)
end)
